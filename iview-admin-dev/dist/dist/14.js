webpackJsonp([14],{251:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o(434),r=o.n(a);for(var n in a)"default"!==n&&function(t){o.d(e,t,function(){return a[t]})}(n);var i=o(498),l=o.n(i),s=o(4),c=s(r.a,l.a,!1,null,null,null);c.options.__file="src/views/reptile-tool/progress-error.vue",e.default=c.exports},284:function(t,e,o){t.exports={default:o(285),__esModule:!0}},285:function(t,e,o){o(286),t.exports=o(0).Object.assign},286:function(t,e,o){var a=o(8);a(a.S+a.F,"Object",{assign:o(287)})},287:function(t,e,o){"use strict";var a=o(26),r=o(54),n=o(34),i=o(33),l=o(94),s=Object.assign;t.exports=!s||o(20)(function(){var t={},e={},o=Symbol(),a="abcdefghijklmnopqrst";return t[o]=7,a.split("").forEach(function(t){e[t]=t}),7!=s({},t)[o]||Object.keys(s({},e)).join("")!=a})?function(t,e){for(var o=i(t),s=arguments.length,c=1,u=r.f,d=n.f;s>c;)for(var p,f=l(arguments[c++]),m=u?a(f).concat(u(f)):a(f),h=m.length,g=0;h>g;)d.call(f,p=m[g++])&&(o[p]=f[p]);return o}:s},434:function(t,e,o){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=o(284),n=a(r),i=o(17),l=a(i);e.default={name:"progress-error",data:function(){var t=this;return{loading:!1,reptileList:l.default.reptileList,columns:[{title:"id",key:"id"},{title:"备注",key:"reptileType",render:function(e,o){return e("span",{},""+t.reptileList[o.row.reptileType].remark)}},{title:"书名",key:"bookName"},{title:"章节名",key:"catalogName",render:function(e,o){return e("a",{attrs:{href:"javascript:void(0)",target:"_blank"},on:{click:function(){t.onJumpToCatalogInfo(o.row.bookName,o.row.catalogName)}}},o.row.catalogName)}},{title:"来源地址",key:"originUrl",render:function(t,e){var o="";return o=0===e.row.reptileAddress.indexOf("http")?e.row.reptileAddress:e.row.originUrl+e.row.reptileAddress,t("a",{attrs:{href:o,target:"_blank"}},o)}},{title:"操作",key:"handle",render:function(e,o){return e("div",[e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;"},on:{click:function(){t.onClickDel(o.row.id)}}},"删除"),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;",id:o.row.title+"_"+o.row.id},on:{click:function(){t.onClickUpdate(o)}}},"爬取"),e("a",{attrs:{href:"https://www.baidu.com/s?wd="+o.row.bookName,style:"margin-left:10px;",target:"_blank"}},"其他来源")])}}],list:[],params:{page:1,limit:10},total:0,bookName:"",showSimpleReptile:""}},computed:{},methods:{onClickSearch:function(t){var e=this;if(!this.loading){t&&(this.params.page=t),this.bookName?this.showSimpleReptile=this.bookName:this.showSimpleReptile="";var o={params:{page:this.params.page,limit:this.params.limit}};this.bookName&&(o.params.bookName=this.bookName),this.$router.replace({path:"/reptile-tool/progress-error",query:(0,n.default)({},o.params)}),this.loading=!0,l.default.post.reptile.getProgressList(o).then(function(t){e.list=t.data,e.total=t.count,e.loading=!1}).catch(function(t){e.loading=!1})}},onClickDel:function(t){var e=this,o={params:{errorId:t}};this.loading=!0,l.default.post.reptile.deleteError(o).then(function(t){e.$Message.success(t),e.loading=!1,e.onClickSearch()}).catch(function(t){e.loading=!1})},onClickUpdate:function(t){var e=this,o=document.getElementById(t.row.title+"_"+t.row.id).innerHTML;if("已获取"!=o&&"正在获取中"!=o){document.getElementById(t.row.title+"_"+t.row.id).innerHTML="正在获取中";var a={params:{errorId:t.row.id}};l.default.post.reptile.restartCatalog(a).then(function(t){e.$Message.success(t),e.onClickSearch()}).catch(function(e){document.getElementById(t.row.title+"_"+t.row.id).innerHTML="获取失败"})}},onClickOneKey:function(t){var e=this,o={params:{}};"all"==t||(o.params.bookName=this.showSimpleReptile),this.loading=!0,l.default.post.reptile.oneKeyRestartCatalog(o).then(function(t){e.$Message.success(t),e.onClickSearch(),e.loading=!1}).catch(function(t){e.loading=!1})},onJumpToCatalogInfo:function(t,e){var o=this,a={params:{bookName:t,catalogName:e}};this.loading=!0,l.default.post.common.getCatalogFromInfo(a).then(function(t){if(o.loading=!1,t.count>0){var e=t.data[0],a=document.createElement("a");return a.href="/#/bookContainer?bookId="+e.bookId+"&catalogId="+e.id+"&num="+e.num,a.style.display="none",a.setAttribute("target","_blank"),a.click(),void a.remove()}o.$message.error("未知错误")}).catch(function(t){console.error(t),o.loading=!1})}},components:{},created:function(){},mounted:function(){var t=this.$route.query.bookName||"";t!=this.bookName&&(this.bookName=t),this.onClickSearch()},beforeDestroy:function(){},destroyed:function(){},activated:function(){var t=this.$route.query.bookName||"";t!=this.bookName&&(this.bookName=t,this.onClickSearch())},deactivated:function(){}}},498:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Layout",[o("Card",[o("Row",[o("Col",{attrs:{span:"24"}},[o("Input",{staticClass:"w200",attrs:{placeholder:"输入书名",clearable:""},nativeOn:{keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.onClickSearch(1)}},model:{value:t.bookName,callback:function(e){t.bookName=e},expression:"bookName"}}),t._v(" "),o("Button",{attrs:{type:"primary"},on:{click:function(e){t.onClickSearch(1)}}},[t._v("搜索")]),t._v(" "),t.showSimpleReptile?o("Button",{attrs:{type:"primary"},on:{click:function(e){t.onClickOneKey()}}},[t._v(t._s(t.showSimpleReptile)+"一键爬取")]):t._e(),t._v(" "),o("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(e){t.onClickOneKey("all")}}},[t._v("全部一键爬取")])],1)],1)],1),t._v(" "),o("Card",{attrs:{shadow:""}},[o("Table",{ref:"table",attrs:{border:"","highlight-row":"",loading:t.loading,columns:t.columns,data:t.list}})],1),t._v(" "),o("Card",{attrs:{shadow:""}},[o("Page",{attrs:{current:t.params.page,"page-size":t.params.limit,total:t.total,"show-total":""},on:{"on-change":t.onClickSearch}})],1)],1)},r=[];a._withStripped=!0;var n={render:a,staticRenderFns:r};e.default=n}});